<html>
    <head>
        <title>Machine Learning</title>
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"> 
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> 
        <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
    </head>
    <body class="bg-light">
        <div class="container mt-5">
            <h2 class="mb-4">Machine Learning Örneği</h2>
            <p>Öğrenci başarı tahmin uygulaması</p>
            <button id="trainBtn" class="btn btn-primary">Eğitimi başlat</button>
        
            <div class="mt-4">
                <h5>Eğitim Çıktısı</h5>
                <pre id="output" class="bg-dark text-light p-3 rounded"
                style="height: 300px; overflow: auto;"></pre>
            </div>
        
        
        </div>
        
    </body>
    <script>

        var model;

        $(document).on("click", '#trainBtn', async function(){
            $('#output').text("Eğitim başlatılıyor...\n");

            var model = tf.sequential();

            // İlk gizli katman
            model.add(tf.layers.dense({
                units: 8, // 8 nöron
                inputShape: [2], // 2 girdi (ders saati, geçmiş not ortalaması)
                activation: 'relu' // Aktivasyon fonksiyonu
            }))

            // İkinci gizli katman
            model.add(tf.layers.dense({
                units: 4, // 4 nöron
                activation: 'relu'
            }))

            // Çıkış katmanı
            model.add(tf.layers.dense({
                units: 3, 
                activation: 'softmax' // Çok sınıflı sınıflandırma için softmax
            }))

            // Modeli derleme
            model.compile({
                optimizer: tf.train.adam(0.01), 
                loss: 'categoricalCrossentropy',
                metrics: ['accuracy']
            });

            // Eğitim Verileri 

            var xs = tf.tensor2d([
                [1, 50], [2, 55], [3, 60], [4, 65],
                [5, 70], [6, 75], [7, 80], [8, 90],
                [9, 100]
            ])

            var ys = tf.tensor2d([
                [1,0,0], [1,0,0], [0,1,0], [0,1,0],
                [0,1,0], [0,1,0], [0,0,1], [0,0,1],
                [0,0,1]
            ])

            $('#output').append("Model eğitiliyor...\n");
            await model.fit(xs, ys, {
                epochs: 200,
                callbacks: {
                    onEpochEnd: (epoch, logs) => {
                        $('#output').append(`Epoch ${epoch + 1}: loss = ${logs.loss.toFixed(4)}, accuracy = ${logs.acc.toFixed(4)}\n`);
                    }
                }
            });
            $('#output').append("Eğitim tamamlandı!\n");

            var testValue = tf.tensor2d([[5, 72]]); // 5 saat ders, 72 not ortalaması
            var prediction = model.predict(testValue);
            var result = await prediction.array();

            $('#output').append(`Tahmin sonucu (5 saat ders, 72 not ortalaması): [Başarısızlık: ${result[0][0].toFixed(4)}, Orta: ${result[0][1].toFixed(4)}, Başarı: ${result[0][2].toFixed(4)}]\n`);
            console.log(result);
        })

        $(document).ready(function(){

            console.log("Sayfa yüklendi - Machine Learning");
        })

    </script>
</html>